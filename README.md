<h1>SOC Automation (Home Lab) - Part 1</h1>

<p align="center">
<img src="https://snipboard.io/6rb2ue.jpg" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<h2>Description</h2>
<br />
<p align="center">
Welcome to part two of five for the series on the active directory project. If you haven't seen part one where we go over how to build a diagram for this lab I highly recommend that you go and see that. I will be referencing that diagram throughout this five-part series. 
  
  Today our objective is to install our virtual machines on Virtual Box. By the end of this part, you should have a Windows 10 machine, one Kali Linux, one Ubuntu server, and one Windows Server 2022. As a quick side note, you will have to create these in the cloud if you are running M1, M2, or M3 Mac. Previously we used Digital Ocean, however, it did cause some issues when trying to connect or spin up Windows so instead, I would highly recommend you use either Vultur or Microsoft Azure. I'll leave a link down below for those who want to sign up with Vultur to get $100 free credit,
  
An Active Directory is simply a database that contains users, computers, groups, and many more. To use the active directory, a server must install a service called Active Directory Domain Services, and the server must then be promoted to a domain controller. By promoting our server to a DC, it will grant us the capability to perform an authentication using a protocol called Kerberos and Authorization for our domain. 
 
 With AD DS, we will have a database that will contain objects such as users, computers, groups, and many more, as previously mentioned. These objects will contain attributes which are information about the object. For example, an object user "Bob" may contain the attribute of Bob's first and last name. That is a quick overview of our virtual machine.
 
 We will be using using Windows 10 as our target machine, Kali Linux for the attacker machine, Windows Server 2022 for the active directory, and Ubuntu Server 22.04 for Splunk. Now I will be hosting all of these virtual machines on Virtual Box, but you can always use the cloud. If you aren't sure how to install Virtual Box with both Windows 10 and Kali, I'll help you go through that right now.
 
First, we'll begin with installing Virtual Box by heading over to their site virtualbox.org. Now depending on the operating system you have, that is the one that we're going to be downloading. So we can go ahead and click "Download Virtual box 7.0". From here we know that this machine that I'm using is a Windows host machine. So I'll go ahead and click download on that.

While that's downloading, we can go ahead and check out the sha256 checksums as well. When you go into the check sums, it will provide you with a list of Sha256 hashes and then this way we can verify the downloaded file to determine whether or not it has been altered, so let's go ahead and do that.

We'll head over to the downloads directory in which our file lives. We'll open Powershell, and then I'll type Get-FileHash .\VirtualBox-7.0.10-158379-win.exe'. click on "enter" and by default, sha256 is generated. What we can do is double-click that and then we can paste it in and see if it matches up.

So we know for a fact that the file in transit was not changed whatsoever. Now we can go ahead and double-click Virtual Box to start installing it. Now we might get hit with a compatibility issue or missing some software dependencies, but we'll deal with that when the time comes.

Click on "yes" and from here we notice that there is a "Microsoft Visual C++ 2019" package dependency. So what we'll do is go ahead and install this dependency. I'll put the link down in the description below just in case that you get hit with this dependency as well.

I went ahead and downloaded the dependency and installed it, so now we can go ahead and double-click the Virtual Box installer again. Hit "yes" and now it doesn't give me that dependency error anymore.

We are presented with some of the features which we can install and they are all set to be installed by default, but you do have the option to customize it; which is quite nice.

Here you can change where you want Virtual Box to be installed in. For example, if you don't have enough space in the "C" drive, you can always install it in a different drive if you like, but in this case, we'll go with the default and hit "Next".

This will provide you with a warning that it will reset your network connection and temporarily disconnect you. Hit "Yes" and install the needed dependencies. Once it's done installing, you should see this sign and all you have to do is click on "Finish". Now Virtual Box should automatically pop up.

We'll navigate to the link which I'll list down in the description for you and once we're on the page, we can go ahead and scroll down and click on "Download tool now". This will download what is called a media creation tool which will help you generate a Windows ISO image file.

So we can go ahead and double-click that to open the file. Click on "yes" and now it will get a few things ready. You'll eventually be presented with this license agreements page and we can go ahead and hit "Accept". It will say getting a few things ready again.

Once it's done checking things, you should be presented with a screen displaying two options. One to upgrade your PC, or two, to "create an installation media". What we want to select is "Create the installation media" and hit "Next".

You have the option to customize your settings such as language, edition, and architecture, but I'll leave mine checked to use the recommended option for this PC. Hit "Next". Now we are presented with two media choices, to use a USB flash drive or an ISO file. We'll select the ISO file. Hit "Next" and save the ISO file anywhere you like.

So now that my Windows ISO image has been successfully downloaded, we can now jump over to our Virtual Box and start creating a virtual machine. We'll open up the window for Virtual Box and click on "New". We can enter a name for a virtual machine and select the directory where we want to store our files.

So I'll go ahead and name our virtual machine "demo". I'll leave the folder as it is for the iso image. I'll click on this and select the drop down. Click on "Other" and now I'll find the iso image that I just downloaded. It was listed under "Document" and double-click the windows ISO. 

At the bottom theres an option where you can check skip unintended installation, which I will do. That way I can install the operating system manually. Now you can uncheck this or check this it's up to you. I'll click on "Next". Here we have the option to configure our virtual machine specifications. However, do be aware that this will be relying on your computer's specifications for this demo.

I'll set my base memory for this virtual machine as 4 gigs and we'll have it as one CPU. I'll click on "Next". For the virtual hard disk, I'll leave it as 50 gigs and hit "Next". Now this will give you a nice summary as to what your settings are for this virtual machine. 

If you're good to go, click on "Finish" and now we can go ahead and start powering it on. To power it on, you just hit this arrow that says "Start". Now once it's running, we should be able to start seeing this Windows 10 setup. So we'll go ahead and select "Next" and hit "Install now".

Once you're presented with this activated Windows screen, go ahead and select "I don't have a product key", and as for the option select "Windows 10 Pro". Hit "Next", and accept the license terms. Here you have the option to upgrade, or custom install Windows only. I'm going to select "Custom: Install Windows only".

Hit "Next" and now Windows 10 should be installed in the background. To install Kali, we want to head over to their site "Kali.org". Once we're on their site, we want to click on "Download" and we'll be presented with a bunch of different options.

The nice thing about Kali is that they have a pre-built virtual machine that we can download and import into our own Virtual Box, which is what we'll do now. You do have the option to go ahead and manually download Kali Linux via an ISO file, similar to how we did it with Windows 10. Let's go and download the pre-built virtual machine.

I'll be downloading the 64-bit version of Kali, but if you have a 32-bit machine, select the 32-bit. To check whether or not you have a 32 or 64-bit machine, you can click on the Windows key and type in "System Information. From here, you can take a look at your system type. In my case, it's an 'x64' meaning it's a 64-bit.

Another way to look at it is if you click on the File Explorer. Then open up your directories. Click on the "C drive". If you happen to notice two individual directories, your program files, and a program file x86, that's another telltale sign that your computer is a 64-bit computer.

Now if you only have one of these directories, it is likely your computer is a 32-bit machine. Looking at the download for Kali Linux, I noticed that it is a seven-zip file extension. Meaning that if you don't have seven-zip installed on your machine, I would highly recommend it to install 7zip.

We'll go ahead and navigate to their website 7-zip. Take a look at your architecture, if it's a Windows 64-bit machine or 32-bit machine, download the appropriate one for you. In my case, it's a 64-bit machine, so I'll go ahead and download that. Once that is downloaded, I'll go ahead and install it.

Kali has finished downloading and there is one thing I forgot to mention, and that is the default credentials. To log into Kali Linux, the default credentials is the username "Kali" and the password "Kali" as well. Let's head over to our our downloads folder and now since we have seven zip installed, we can go ahead and right-click the Kali Linux archive.

Go to 7-zip and click on "Extract to" directory. Now that it is done extracting, let's head into that folder. All you need to do is double-click on the ".vBox" file. If you don't see the file extension, you can simply click on "View" and check "File name extensions". Once we do that, we can now see the vbox file extension.

Once we double-click that, it should automatically be imported into our virtual box. So we can go ahead and start Kali and when you're on the log-on screen just remember to log in with "Kali" and "Kali" as the password. Once you have virtual box installed, along with Windows 10 and Cali Linux, we can now begin installing our Windows Server.

Over to Google, we want to search up Windows Install Windows Server Server 2022 ISO and we want to select the Windows Server 2022 Microsoft evaluation center this is where we will download our ISO file by clicking on download the iso and then we need to fill in the information once you fill in the information you should be presented with the screen the next thing to do is click on 64-bit Edition under ISO downloads and depending on your speeds this might take a while however once the iso is finished downloading we then want to start adding this onto our virtual machine to do this we want to click on the new icon and then provide your virtual machine with a name I will call it add dc01 and then the folder you can select the folder of where you want to Output your virtual machine as for the iso image we want to select the one that we just downloaded and we want to leave all of this as default but I will select skip unintended installation because I don't want virtual box to automatically install this as I have experienced some errors in the past when I was using it now under the hardware tab it is set to 2 gigs by default so I will actually change this over to four now this might be a little slow but that is okay as long as it works and if you have a computer that only has 8 gigs of RAM for example I would recommend you shut off all of your virtual machines and install them one at a time once everything is installed then you want to change your specs back to 2 gigs instead of four as this will help you save some resources but in the beginning stay with 4 gigs until everything is installed as for hard disk I am going to leave it as 50 gigs because I think that's good enough and I will select finish now we can go ahead and just hit start so once the virtual machine is booted up you'll see the setup and I will leave it as default and hit next and select install now as for the operating system you want to install you want to select the second option which is Windows Server 2022 standard edition desktop experience if you don't select that you'll just get a CLI a command line interface and it can be pretty tough to navigate around it so make sure you select the second option and then hit next accept the terms and agreements and we want to select custom and hit next now this will take its time and install Windows Server 2022 on onto our virtual machine all right so this took about 10 minutes and after the setup is completed you should be presented with this screen to create our own password now of course I will type in a super secure password and then I'll click on finish after a couple seconds we can now start to log in using the username administrator and the password that we had just set as an FYI to perform a control alt delete onto your virtual machine because it does say hey press control alt delete to unlock we can do this by selecting the input tab at the top go over to keyboard and insert control alt delete or you can use the shortcut key that is listed over here we'll log in with the password that we just created and once we log in we can just go ahead and select no for now and we'll see an application called server manager which is what we'll use to install our active directory but that will be in part four of the series now that we have our Windows Target machine Cali Linux and Windows Server installed the last thing to do is install our Splunk server over to our web browser
Install Splunk Server let's head over to ubuntu.com and under products we want to select Ubuntu Server now we can click on download Ubuntu server and as of recording the version that we are downloading is Ubuntu server 22.04.2012 any form of but of course we want to skip the unintended installation as for Hardware I am going to set this to 8 gigs but again depending on your hardware specs you can set this to four and I'll also select my processors to two we want to make Splunk a little beefier compared to our other virtual machines because this is going to be ingesting data and we'll be running searches on it for our hard disk I'll go ahead and bump this over to 100 gigs and hit finish now we can go ahead and Power It On by clicking on start once you're presented with the screen go ahead and select the first option which is try or install UB ubuntu server for the options I'll leave it as default and continue hitting enter continue without updating that's fine done done done done and done perfect so now we want to select continue and with the guided storage configuration we need to use the down arrow to go over to done click done and go into to continue finally we are presented with the options to enter in your name your username and password for my name I'll just select Bob the server name I'm going to say Splunk the username I'll say my dfir and the password make it super secure and hit done now we don't need Ubuntu Pro so we can go ahead and skip that for now and open SSH it is up to you if you want to install it I'm just going to skip it and we don't need any of these options so scroll all the way down and hit done now our setup is going to start installing Ubuntu Server onto our virtual machine so you know when your installer is completed after you see a reboot now option so we'll go ahead and select that and hit enter you will get an error saying failed unmounting CD ROM but don't worry we can simply hit enter and if you want you can go ahead and remove the ISO file but again I'll just leave it as is once Ubuntu finishes up with its reboot we are now presented with a loog loog on screen and we'll use the account that we just created earlier so in my case it is my dfir and of course the password if this is your first time doing this you might notice that when typing in a password you don't see any input and don't worry this is by design it is not shown for security purposes but do note if you do make a mistake just go ahead and hit backspace to remove everything or you can go ahead and hit enter to reset everything and then try Relogging in again I'll type in my dfir and and my password once we're logged in let's run a quick pseudo AP get update and PSE sudo apt get upgrade Dy and hit enter It'll ask for my password again using this command will go out and update and upgrade all of our repositories once you are presented with this screen you can go ahead and hit enter and now our server is ready to go we should have a total of four virtual machines ready to go and in part three we will start to install cismon and Splunk onto our Target machine and server and that is it for the video I hope this has been helpful for you so far and if you stumbled across any errors along the way leave it in the comment section down below remember to stay curious and do things differently
